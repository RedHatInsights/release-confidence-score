# Release Documentation

This file provides context for AI-powered release risk analysis. Create a `.release-confidence-docs.md` file in your repository root with information relevant to your project.

## Service Overview

**Project Type:** [SaaS Service / CLI Tool / Library / Backend API / Frontend App]
**Criticality:** [Critical / High / Medium / Low]
**Description:** Brief description of what this project does.

### For SaaS/Backend Services
- **Traffic:** Request volume and patterns (e.g., "50K requests/hour, peak at 9am UTC")
- **SLA:** Uptime and performance targets (e.g., "99.9% availability, P95 < 200ms")
- **Business Impact:** Consequences of downtime (e.g., "Blocks customer checkout flow")

### For CLI Tools/Libraries
- **Users:** Who uses this and how (e.g., "CI/CD pipelines, ~500 daily runs")
- **Compatibility:** Version requirements (e.g., "Supports Go 1.21+, Linux/macOS/Windows")
- **Breaking Changes:** API stability policy (e.g., "Follows semver, v1.x is stable")

---

## Architecture Overview

### Key Components

Describe the main parts of your system:

**For a SaaS service:**
- **API Server:** Handles REST requests, authenticated via OAuth
- **Worker:** Processes background jobs from Redis queue
- **Database:** PostgreSQL with read replicas

**For a CLI tool:**
- **Parser:** Handles command-line arguments and configuration
- **Core Engine:** Main processing logic
- **Output Formatter:** Generates reports in multiple formats

### External Dependencies

List critical external services or systems:

| Dependency | Purpose | Failure Impact |
|------------|---------|----------------|
| PostgreSQL | Primary data store | Complete outage |
| Redis | Job queue, caching | Degraded performance |
| Auth Service | User authentication | Users cannot log in |

---

## Deployment Risks

### High-Risk Changes

Identify changes that require extra scrutiny:

1. **Database Migrations**
   - Tool: Flyway / Alembic / goose
   - Rollback: [Automatic / Manual scripts / Not supported]
   - Notes: Large tables may require maintenance window

2. **Authentication/Authorization**
   - Scope: User auth, API keys, RBAC
   - Impact: All authenticated operations
   - Testing: Requires integration test coverage

3. **API Contract Changes**
   - Versioning: /v1/, /v2/ prefixes
   - Clients: Frontend app, mobile apps, third-party integrations
   - Breaking changes require deprecation period

4. **Configuration Changes**
   - Environment variables, feature flags
   - Different values between staging and production
   - Validate in staging before production deploy

### For CLI Tools/Libraries

1. **Breaking CLI Changes**
   - Flag renames, removed commands
   - Output format changes
   - Exit code changes

2. **Dependency Updates**
   - Major version bumps
   - Security patches
   - Platform compatibility

---

## Known Risk Patterns

Document issues that have caused problems before:

| Pattern | Symptom | Prevention |
|---------|---------|------------|
| Connection pool exhaustion | Timeouts under load | Monitor active connections |
| Memory leak in worker | OOM after 24h | Restart workers daily |
| Race condition in cache | Stale data served | Use distributed locks |

---

## Rollback Procedures

### Quick Rollback (< 5 minutes)

For changes that can be instantly reverted:

```bash
# Revert to previous container image
kubectl rollout undo deployment/my-service

# Or disable via feature flag
curl -X POST https://flags.example.com/api/flags/new-feature/disable
```

### Database Rollback

For changes involving data migrations:

1. Stop new deploys
2. Run rollback migration: `./migrate down 1`
3. Deploy previous application version
4. Verify data integrity

### When Rollback Is Not Possible

Some changes cannot be rolled back:
- Destructive migrations (dropped columns/tables)
- External API contract changes already consumed
- Data format changes without backward compatibility

**Mitigation:** Deploy these changes with feature flags, validate thoroughly in staging.

---

## Monitoring & Verification

### Health Checks

| Endpoint | Purpose | Expected Response |
|----------|---------|-------------------|
| `/health` | Basic liveness | 200 OK |
| `/ready` | Readiness probe | 200 when ready to serve |
| `/metrics` | Prometheus metrics | Metrics payload |

### Key Metrics to Watch After Deploy

- Error rate (should stay < 0.1%)
- Response time P95 (should stay within 20% of baseline)
- Queue depth (should not grow continuously)
- Memory/CPU usage (should stabilize within 10 minutes)

### Deployment Success Criteria

Consider deployment successful when:
- [ ] Health checks pass for 5+ minutes
- [ ] Error rate remains at baseline
- [ ] No new alerts triggered
- [ ] Smoke tests pass

---

## File Risk Patterns

Help the AI understand which files are high-risk in your project:

### High-Risk Files
- `migrations/` - Database schema changes
- `config/production/` - Production configuration
- `auth/` or `security/` - Authentication logic
- `api/v*/` - Public API definitions

### Medium-Risk Files
- `go.mod`, `package.json` - Dependency changes
- `Dockerfile`, `docker-compose.yml` - Build/deploy changes
- `.github/workflows/` - CI/CD pipeline changes

### Low-Risk Files
- `*_test.go`, `*.spec.ts` - Test files
- `docs/`, `*.md` - Documentation
- `.gitignore`, `.editorconfig` - Tooling config

---

## Additional Documentation

**Only links in this section are automatically fetched by the AI tool.**

- [Architecture Overview](./docs/architecture.md)
- [API Reference](./docs/api.md)
- [Runbook](./docs/runbook.md)
- [Monitoring Guide](./docs/monitoring.md)

Links outside this section are ignored by the tool but useful for human readers.

---

## Tips for Better Analysis

1. **Be specific** - "P95 < 200ms" is better than "fast"
2. **Include real examples** - Actual thresholds, actual commands
3. **Document what has failed** - Historical issues help predict future risks
4. **Keep it updated** - Review after major changes or incidents
5. **Focus on deployment risks** - This doc is for release analysis, not general docs
